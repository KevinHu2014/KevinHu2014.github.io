---
layout: post
title: "git-flow"
date: 2017-09-26 14:40:20 +0800
comments: true
categories: Git
---
# Git flow ç­†è¨˜

## å‰è¨€
åœ¨å…¬å¸é–‹ç™¼å°ˆæ¡ˆçš„æ™‚å€™ï¼ŒåŒäº‹å‰›å¥½éœ€è¦é–‹ç™¼ä¸€å€‹æ–°çš„featureï¼Œè€Œé€™å€‹featureéœ€è¦å¿…è¼ƒä¹…çš„æ™‚é–“æ‰èƒ½å›åˆ°masterï¼Œæ­¤æ™‚æˆ‘å€‘é‡æ–°æª¢è¦–äº†åŸä¾†ä½¿ç”¨çš„é–‹ç™¼æµGithub Flow æ˜¯ä¸æ˜¯æœ‰ä»€éº¼ç¼ºé»ï¼Œä¸¦ä¸”ä¹Ÿè¨è«–åˆ°å¦‚æœè½‰åˆ°Git flowæ˜¯å¦èƒ½è§£æ±ºç¾æ³ä¸‹é‡åˆ°çš„å•é¡Œã€‚

## ç°¡ä»‹
Flow ç¿»æˆä¸­æ–‡æ˜¯ ã€æ°´æµã€çš„æ„æ€ï¼Œé€™è£¡æˆ‘å€‘å¯ä»¥ç†è§£æˆå·¥ä½œæµç¨‹ï¼Œå°±åƒæ°´æµä¼¼çš„é †æš¢æµå‹•ã€‚

å»£æ³›è¢«ä½¿ç”¨çš„å·¥ä½œæµæœ‰ä¸‰ç¨®ï¼š

* Git flow
* Github flow
* Gitlab flow

è€Œæœ¬æ–‡ä¸»è¦æŠŠé‡é»æ”¾åœ¨Git flowã€‚

Git é›–ç„¶æ–¹ä¾¿å¥½ç”¨ï¼Œä½†ä¸¦æ²’æœ‰æå‡ºä¸€å¥—ç®¡ç†åˆ†æ”¯çš„æ–¹æ³•ï¼Œè€Œåœ‹å¤–æœ‰å¤§å¤§æ•´ç†å‡ºä¸€å¥—æ–¹æ³•: [A successful Git branching model](http://nvie.com/posts/a-successful-git-branching-model/)ï¼Œè€Œé€™å¥—æ–¹æ³•å°±æ˜¯å¤§å®¶ç†ŸçŸ¥çš„Git flowã€‚


Git flow çš„ä¸»è¦æ¦‚å¿µå°±æ˜¯ä»–æœ‰å…©å€‹ä¸»è¦çš„branch
![](http://nvie.com/img/main-branches@2x.png)

åˆ†åˆ¥ç‚ºmaster å’Œ develop

developæ˜¯è² è²¬é–‹ç™¼çš„åˆ†æ”¯ï¼Œè€Œmasteræ˜¯çµ¦productionç”¨çš„

è€Œæ¬¡è¦åˆ†æ”¯æœ‰feature, release è·Ÿhotfix

![](http://nvie.com/img/git-model@2x.png)
ç¬¬ä¸€æ¬¡çœ‹åˆ°é€™å¼µåœ–å¯èƒ½æœƒè¢«åš‡åˆ°å§www ï¼Œä½†é€™å¼µåœ–å…¶å¯¦æ²’æœ‰æƒ³åƒä¸­çš„è¤‡é›œï¼Œåªæ¯”å‰ä¸€å¼µåœ–å¤šäº†ä¸‰å€‹æ¬¡è¦åˆ†æ”¯ã€‚

æ¥ä¸‹ä¾†å°±ä¸€ä¸€ä¾†ä»‹ç´¹ä»–å€‘ï½

é¦–å…ˆæ˜¯feature åˆ†æ”¯ï¼Œä½¿ç”¨æ™‚æ©Ÿæ˜¯åªè¦æ˜¯é–‹ç™¼æ–°åŠŸèƒ½çš„æ™‚å€™ï¼Œ
å°±é–‹æ–°çš„feature åˆ†æ”¯ï¼Œè€Œç•¶æ­¤feature åˆ†æ”¯é–‹ç™¼å®Œå¾Œï¼Œ
å°±å°‡å®ƒ merge å› develop åˆ†æ”¯ã€‚


å†ä¾†æ˜¯release åˆ†æ”¯ï¼Œä½¿ç”¨æ™‚æ©Ÿæ˜¯åœ¨é€å‡ºä¸‹ä¸€ç‰ˆå‰è¦ä¿®æ­£bugçš„æ™‚å€™ï¼Œ
æ­¤æ™‚å°±é–‹æ–°çš„release åˆ†æ”¯ï¼Œè€Œç•¶æ­¤release åˆ†æ”¯é–‹ç™¼å®Œå¾Œï¼Œè®“ä»–åŒæ™‚å›åˆ°develop é‚„æœ‰ master åˆ†æ”¯ã€‚

è€Œè‡³æ–¼hotfix åˆ†æ”¯ä½¿ç”¨çš„æ™‚æ©Ÿå‰‡æ˜¯åœ¨ä¿®å·²ä¸Šproduction å¾Œè‡¨æ™‚è¦ä¿®bugæ™‚ï¼Œç•¶hotfix åˆ†æ”¯é–‹ç™¼å®Œå¾Œï¼Œè®“ä»–åŒæ™‚å›åˆ°develop é‚„æœ‰ master åˆ†æ”¯ã€‚




## æ•™å­¸

ç”±æ–¼Git flow ä¸æ˜¯Git è£¡åŸæœ‰çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦å¦å¤–å®‰è£ä½œè€…æ‰€æä¾›çš„[gitflow](https://github.com/nvie/gitflow) å·¥å…·ã€‚

è€Œé€™è£¡å°±ä»¥Mac OS Xä¾†åšæ•™å­¸ï¼Œä¸¦å‡è¨­ä½ æœ‰è£[homebrew](https://brew.sh/index_zh-tw.html)ã€‚

###  å®‰è£
    $ brew install git-flow

### ç‚ºå°ˆæ¡ˆåŠ å…¥Git flow

    $ git flow init

### å»ºç«‹åˆ†æ”¯
#### feature

åˆ—å‡ºæ‰€æœ‰çš„feature branch

    $ git flow feature  

é–‹å•Ÿæ–°çš„ feature branch

    $ git flow feature start <name>

* name ç‚ºä½ æƒ³è¦çš„feature åˆ†æ”¯åç¨±

çµæŸfeature branch

    $ git flow feature finish <name>

* name ç‚ºä½ æƒ³è¦çµæŸçš„åˆ†æ”¯åç¨±
* feature åˆ†æ”¯å®Œæˆå¾Œæœƒè¢« mergeé€² develop åˆ†æ”¯

æŠŠfeature åˆ†æ”¯ æ¨åˆ° remote

    $ git flow feature publish <name>
* name ç‚ºä½ æƒ³è¦æ¨çš„åˆ†æ”¯åç¨±

æŠŠremoteçš„ feature åˆ†æ”¯æ‹‰ä¸‹ä¾†

    $ git flow feature pull <remote> <name>
* remote é€šå¸¸æ˜¯ origin çš„æ¨£å­? <-  é€™è£¡å¯èƒ½é‚„è¦è«‹å¤§å¤§ç³¾æ­£
* name ç‚ºä½ è¦æ‹‰çš„åˆ†æ”¯åç¨±

#### release

åˆ—å‡ºæ‰€æœ‰çš„ release branch

    $ git flow release  

é–‹å•Ÿæ–°çš„ release branch

    $ git flow release start <release>

* release ç‚ºä½ æƒ³è¦çš„ release åˆ†æ”¯åç¨±

çµæŸ release branch

    $ git flow release finish <release>

* release ç‚ºä½ æƒ³è¦çµæŸçš„åˆ†æ”¯åç¨±
* release åˆ†æ”¯å®Œæˆå¾Œæœƒè¢« mergeé€² develop åˆ†æ”¯ å’Œ master åˆ†æ”¯


#### hotfix

åˆ—å‡ºæ‰€æœ‰çš„ hotfix branch

    $ git flow hotfix  

é–‹å•Ÿæ–°çš„ hotfix branch

    $ git flow hotfix start <release>

* release ç‚ºä½ æƒ³è¦çš„ hotfix åˆ†æ”¯åç¨±

çµæŸ hotfix branch

    $ git flow hotfix finish <release>

* hotfix ç‚ºä½ æƒ³è¦çµæŸçš„åˆ†æ”¯åç¨±
* release åˆ†æ”¯å®Œæˆå¾Œæœƒè¢« mergeé€² develop åˆ†æ”¯ å’Œ master åˆ†æ”¯

## çµè«–

ä»‹ç´¹äº†é‚£éº¼å¤šï¼Œæœ€å¾Œçš„çµè«–æ˜¯æˆ‘å€‘æ²’æœ‰ä½¿ç”¨Git flow ğŸ˜‚ ğŸ˜‚ ğŸ˜‚ï¼Œç”±æ–¼å…¬å¸å°ˆæ¡ˆdeployçš„å¾ˆé »ç¹ï¼ŒåŸºæœ¬ä¸Šmaster å’Œ develop åˆ†æ”¯æ˜¯æ²’æœ‰å·®åˆ¥çš„ï¼Œå†è€…å°±ç®—ä½¿ç”¨Git flow ä¹Ÿç„¡æ³•è§£æ±º feature åˆ†æ”¯å¾ˆä¹…æ‰å›production çš„å•é¡Œï¼Œå› æ­¤é‚„æ˜¯ç¹¼çºŒä½¿ç”¨åŸæœ¬çš„Github flowä¾†ç•¶ä½œæˆ‘å€‘çš„ workflowï¼Œä¸éå‰›å¥½è¶é€™å€‹æ©Ÿæœƒæˆ‘ä¹Ÿå°Git flow æœ‰é€²ä¸€æ­¥çš„èªè­˜ã€‚
